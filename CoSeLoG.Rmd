---
title: 'Dutch Environmental Permit Application Process: CoSeLoG'
author: "bdanalytics"
output:
  pdf_document:
    fig_width: 8
    highlight: zenburn
    #keep_md: yes
    keep_tex: yes
    number_sections: yes
    toc: yes
---
**Date: `r format(Sys.time(), "(%a) %b %d, %Y")`**    

Data: Originates from the CoSeLoG project executed under NWO project number 638.001.211. Within the CoSeLoG project the (dis)similarities between several processes of different municipalities in the Netherlands has been investigated. This event log contains the records of the execution of the receiving phase of the building permit application process in an anonymous municipality.

Source: http://data.3tu.nl/repository/uuid:a07386a5-7be3-4367-9535-70bc9e77dbe6

Time period: 2010-10-02 to 2012-01-23

### Synopsis:

#### Potential next steps include:

### Template:
**Approach I used**:     
Describe exactly what you did (e.g. which plug-ins did you use, which settings did you change), in such a way that others can easily reproduce your results. You only need to describe where/if you deviated from the provided instructions.

**What I saw**:   
Briefly describe the resulting analysis screen (also include this as a screenshot, see explanation below), explain what we see, without including observations or conclusions.

**My analysis**:   
What can you conclude from the analysis result? How do you interpret the result? What is the answer to the question?

```{r set_global_options, echo=FALSE}
rm(list=ls())
set.seed(12345)
#source("~/Dropbox/datascience/R/mydsutils.R")
#source("~/Dropbox/datascience/R/myplot.R")
# Gather all package requirements here
#suppressPackageStartupMessages(require())

#require(sos); findFn("pinv", maxPages=2, sortby="MaxScore")
```

```{r set_global_options_wd, echo=FALSE}
setwd("~/Documents/Work/Courses/Coursera/process-mining/Projects/PM_Assignment")
```

### Step 01: import event log in Disco
**Approach I used**:  
1. Import the event log into Disco.  
2. Switch to "Statistics" tab / view  
3. Click on "Overview" button in the left pane under "Statistics views"  
4. Click on "Events per case" button to the left of the graph  

**What I saw**: 

![](CoSeLoG_Step_01_Q_01.png)

The graph pane displays a histogram (Number of cases) of Events per case in this event log. The event log contains 8,577 events in 1,434 cases with 27 activities.

**My analysis**:  
There are 6 events on average per case. This information can be gathered by hovering the mouse on the tallest bar.

By clicking on "Variants" button on top of the table, we can see that there are only 116 variants amongst the 1,434 cases.

The main observation from the 'Events over time' graph is that the maximum number of events (33) occured on May 2, 2011 across cases.  

### Step 02: inspect process map in Disco
**Approach I used**:  
1. Click on "Map" tab in the window header.  
2. Set "Activities" slider to 0% & "Paths" slider to 50% to make the process map fit on one screen and still be readable.  

**What I saw**: 

![](CoSeLoG_Step_02.png)


**My analysis**:  

The 6 most frequent activities between the initiation and termination of cases in the process map include:  
A. <TA> Confirmation of receipt  
B. T02 Check confirmation of receipt  
C. T04 Determine confirmation of receipt  
D. T05 Print and send confirmation of receipt
E. T06 Determine necessity of stop advice  
F. T10 Determine necessity to stop indication

The most frequent activity paths traced by the cases include (this is supposed to display as a table, but doesn't work properly) :  

                                        Activity Path | # of Cases  
----------------------------------------------------- | -----------  
                                   Start -> TA -> End |     116  
              Start -> TA -> T02 -> T04 -> T05 -> End |     400  
Start -> TA -> T02 -> T04 -> T05 -> T06 -> T10 -> End |     828  
                                                      |    
                    Total cases displayed in this map |    1,344  
                                          Total cases |    1,434  
                        % cases displayed in this map |     94%   

Do not understand why if "<TA> Confirmation of receipt" is complete, there is a need for "T02 Check confirmation of receipt". Additionally, there are 4 activities (TA, T02, T04 & T05) regarding confirmation of receipts. Maybe these activities are not named appropriately ? and/or We need to understand the intermediate activities (e.g. T01, T03) to get a better understanding ?

### Step 03: inspect process performance in Disco

**Approach I used**:  
1. Click on "Performance" bar / button in the "Detail" pane (right above the "Copy" / "Delete" / "Export" icons).  
2. Select "Total Duration" in the "Performance" pane to display.  
3. Select "Case frequency" as the secondary metric in the "Performance" pane to ensure that we don't use outliers (e.g. low case frequency) to make broad conclusions about the process.  
4. Cycle through different metrics in the button next to "Show:" in the Performance pane.  

**What I saw**: 

![](CoSeLoG_Step_03.png)

The color & thickness of the arcs are based on the distribution of the selected primary performance metric. Additionally, if an arc is clicked, a statistics window is dsiplayed for that arc.

**My analysis**:  
*Total Duration*: The arc from T05 to T06 takes 79.6 months for 791 cases (31% of total duration of all cases which is 258.12 months: mean of 5.4 days per case X 1,434 cases / 30 elapsed days per month). The next bottleneck seems to be TA -> T02 which is 29.6 months for 1,079 cases.

Analysis of other metrics (median, mean & max duration) highlighted arcs with very low case frequency.

### Step 04: inspect event log in ProM

**Approach I used**:
   
1. Click on "import..." icon on the upper right hand side of the "Workspace" pane.  
2. Click on eye icon (the one associated with the log in the middle; NOT the top one).    
3. Click on "Create new..." droplist in the top center of the window.  
4. Select "XDotted Chart" by scrolling down the list.
5. Select "Dotted Chart" tab on the left.
6. Select "Occurence of first event" from the droplist for "Case order:" option.  
7. Click on "Apply Settings" button.  

**What I saw**: 

![](CoSeLoG_Step_04.png)

Events for each case are plotted across time and color-coded. Did not see the 'size shows # of events'-option. Zooming in does not make the timeline any more readable / discernible (e.g. do events initiate on weekends ?) 

**My analysis**:  
The arrival of the new cases is fairly constant evidenced by the -45 degree slope of the (approx) line of blue dots. There are some minor fluctuations which is difficult to quantify (clicking on the dots does not display any additional information). 

For the more recent cases there are a lot less events / activities occuring close to case initiation compared to the earlier cases. 

### Step 05: discover Petri net in Disco

**Approach I used**:  
  
1. Click on "Actions" icon.  
2. Add imported event log to "Input".  
3. Search for "Alpha" plug-in.  
4. Select "Mine for a Petri Net using Alpha-algorithm". 
5. Click on "Start" button.  

**What I saw**: 

![](CoSeLoG_Step_05.png)  

This is clearly difficult to work with. Let's filter the event log to make it more comprehensible.  

**Approach I used**:  

6. Click on "Actions" icon.  
7. Search for "Filter Log".  
8. Select "Filter Log using Simple Heuristics".  
9. Click on "Start" button. 
10. Change Log name to "CoSeLoG (filtered on simple heuristics)".  
11. Click on "Next" button.
12. Select "Select top percentage" to 100% because there is only 1 Start event.
13. Click on "Next" button. 
14. Select "Select top percentage" to 100% because ideally keeping all End events would be critical in understanding the process.   
15. Click on "Next" button.
16. Select "Select top percentage" to 96% because this Event filter criterion discards many events and therefore many arcs in the resulting Petri net.
17. Change Log name to "CoSeLoG (96% filtered on simple heuristics)".  
18. Click on "Finish" button.  

**What I saw**: 

![](CoSeLoG_Step_05_Filter96.png) 

The number of Event classes has gone down from 27 to 9. The number of Events has reduced from 8,577 to 8,252 but number of Cases remain the same.

**Approach I used**:  

19. Click on "Workspace" icon. 
20. Select "CoSeLoG (filtered...".  
21. Click on "Actions" icon.  
22. Repeat tasks numbered 1-5 listed earlier in this Step. For task 2, select  "CoSeLoG (96% filtered...)" log to "Input".   

**What I saw**: 

![](CoSeLoG_Step_05_Filter96_PetriNet_Alpha.png)  
  
The Alpha algorithm has discovered 9 transactions & 9 places. However, transactions T06, T07-1 & T10 are not integrated well into the rest of the control-flow.     

**Approach I used**:  

23. Click on "Actions" icon.  
24. Add "CoSeLoG (96% filtered...)" log to "Input".  
25. Search for "ILP" plug-in.  
24. Select "Mine for a Petri Net using ILP". 
25. Click on "Start" button.
26. Select the default options and Click "Finish" button.  

**What I saw**: 

![](CoSeLoG_Step_05_Filter96_PetriNet_ILP.png)

The ILP algorithm has also discovered 9 transactions & 9 places. Additionally, the ILP Petri net handles transactions T06, T07-1 & T10 better by not isolating them from the control-flow. 

**Approach I used**:  

27. Click on "Actions" icon.  
28. Add "CoSeLoG (96% filtered...)" log to "Input".  
29. Search for "Heuristics" plug-in.  
24. Select "Mine for a Heuristics Net using Heuristics Miner". 
25. Click on "Start" button.
26. Select the default options and Click "Continue" button.
27. Click on "Zoom" button to the left of the graphic.  
28. Select zoom level next to "Fit >" on the slider to view the net in its entirety.
29. Capture screen image.  
29. Select zoom level to 50% to make the net more readable.  

**What I saw**: 

![](CoSeLoG_Step_05_Filter96_Heuristics_Net.png)

9 transactions are discovered with a fitness score of 0.63 but T03, T07-1 & T11 are grayed out due to low case frequency (<= 55).  

**Approach I used**:  

30. Click on "Workspace" icon.  
31. Select "Mined Models" of type "HeuristicsNet".  
32. Click on "Actions" icon.  
33. Select "Convert Heuristics net into Petri net" plug-in.  
34. Click on "Start" button.  

**What I saw**: 

![](CoSeLoG_Step_05_Filter96_PetriNet_Heuristics.png)

This approach has discovered 9 transactions again, 14 "hidden" / "silent" transactions and 18 places. However, there does not seem to be a clear "End" place.  

**Approach I used**:  

35. Click on "Workspace" icon.  
36. Select "CoSeLoG (96% filtered...)" log.  
37. Click on "Actions" icon.  
38. Search for "Inductive" plug-in.  
39. Select "Mine Petri net with Inductive Miner" plug-in.  
40. Click on "Start" button. 
41. Change "Variant" option from default of "Inductive Miner - infrequent" to "Inductive Miner" because the default option drops T04 transaction probably due to infrequent cases containing it. We want to keep this transaction so that we can compare the different Petri nets with the same set of transactions.  
42. Click "Finish" button.

**What I saw**: 

![](CoSeLoG_Step_05_Filter96_PetriNet_Inductive.png)

This approach discovered 9 transactions, 25 "hidden" / "silent" transactions & 21 places. 

**My analysis**:  

Argue why one of the Petri nets is better.

Explain the (best) Petri net, what is the main process and what are notable parts of the Petri net?

### Step nn: step title

**Approach I used**:  

**What I saw**: 

![](dummy.png)

**My analysis**:  